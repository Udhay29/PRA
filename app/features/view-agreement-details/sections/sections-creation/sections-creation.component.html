<div class="split-wrapper">
    <div class="ui-g pad0 dropshadow split-container">
        <div class="split-header ui-g-12">
            <span class="title mar-left8">{{ sectionsCreationModel?.splitViewDetails?.titleText }} Section</span>
             <button data-attr="viewagreement-section-sectionCreation-splitScreenClose-button" class="icon-button icon-Menu_Close close-position" (click)="onClose()"></button>
        </div>
        <div class="split-body">
            <form [formGroup]="sectionsCreationModel.sectionForm">
                <div class="ui-md-12 ui-g-12 ui-lg-12 pad0 mar-top3">
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 text-field-float">
                        <input data-attr="viewagreement-section-sectionCreation-sectionName-input" type="text" pInputText formControlName="sectionName" name="sectionName" maxlength="80"
                            spellcheck="false" autocomplete="false" />
                        <label class="top-5" for="sectionName">Section Name</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Section Name " *ngIf="sectionsCreationModel.sectionForm.get('sectionName').touched &&
              sectionsCreationModel.sectionForm.get('sectionName')['errors']?.required"></p-message>
                        </div>
                    </span>
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 typeahead-float">
                        <p-autoComplete data-attr="viewagreement-section-sectionCreation-sectionType-autoComplete" [suggestions]="sectionsCreationModel.filteredSectionType" field="label"
                            formControlName="sectionType" name="sectionType" [forceSelection]="true"
                            (onClear)="onAutoCompleteClear($event.target['value'], 'sectionType')" spellcheck="false"
                            size="100" autocomplete="false" [dropdown]="true"
                            (completeMethod)="onAutoCompleteSearch($event.query, 'sectionTypeList', 'filteredSectionType')">
                        </p-autoComplete>
                        <label class="top-5" for="sectionType">Section Type</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Section Type" *ngIf="sectionsCreationModel.sectionForm.get('sectionType').touched &&
              sectionsCreationModel.sectionForm.get('sectionType')['errors']?.required"></p-message>
                        </div>
                    </span>
                </div>
                <div class="ui-md-12 ui-g-12 ui-lg-12 pad0 mar-top5">
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 typeahead-float">
                        <p-autoComplete data-attr="viewagreement-section-sectionCreation-currency-autoComplete" [suggestions]="sectionsCreationModel.filteredCurrency" field="label"
                            formControlName="currency" name="currency" [forceSelection]="true"
                            (onClear)="onAutoCompleteClear($event.target['value'], 'currency')" spellcheck="false"
                            size="100" autocomplete="false" [dropdown]="true"
                            (completeMethod)="onAutoCompleteSearch($event.query, 'currencyList', 'filteredCurrency')">
                        </p-autoComplete>
                        <label class="top-5" for="currency">Currency Type</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Currency Type" *ngIf="sectionsCreationModel.sectionForm.get('currency').touched &&
              sectionsCreationModel.sectionForm.get('currency')['errors']?.required"></p-message>
                        </div>
                    </span>
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 typeahead-float">
                        <p-autoComplete data-attr="viewagreement-section-sectionCreation-contractId-autoComplete" [suggestions]="sectionsCreationModel.filteredContract" field="label"
                            formControlName="contractId" name="contractId" [forceSelection]="true"
                            (onClear)="onAutoCompleteClear($event.target['value'], 'contractId')" spellcheck="false"
                            size="100" autocomplete="false" [dropdown]="true"
                            (completeMethod)="onAutoCompleteSearch($event.query, 'contractIdList', 'filteredContract')"
                            (onSelect)="contractSelected($event)"
                            [disabled]="sectionsCreationModel.editContractDisable"></p-autoComplete>
                        <label class="top-5" for="contractId">Contract</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Contract" *ngIf="sectionsCreationModel.sectionForm.get('contractId').touched &&
              sectionsCreationModel.sectionForm.get('contractId')['errors']?.required"></p-message>
                        </div>
                    </span>
                </div>
                <div class="ui-md-12 ui-g-12 ui-lg-12 pad0 mar-top5">
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 date-field-float">
                        <p-calendar data-attr="viewagreement-section-sectionCreation-effectiveDate-calendar" formControlName="effectiveDate" [showIcon]="true" name="effectiveDate"
                            appendTo="body" [minDate]="sectionsCreationModel.effectiveMinDate"
                            [maxDate]="sectionsCreationModel.effectiveMaxDate"
                            (onInput)="onTypeDate($event.srcElement['value'], 'effective')"
                            (onSelect)="onDateSelected($event, 0)" [showOnFocus]="true"></p-calendar>
                        <label for="effectiveDate" class="leftPlace">Effective Date</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Effective Date" *ngIf="sectionsCreationModel.sectionForm.get('effectiveDate').touched &&
              sectionsCreationModel.sectionForm.get('effectiveDate')['errors']?.required"></p-message>
                            <p-message severity="error" text="Provide a valid date" *ngIf="sectionsCreationModel.sectionForm.get('effectiveDate').touched &&
              sectionsCreationModel.sectionForm.get('effectiveDate')['errors']?.invalid"></p-message>
                        </div>
                    </span>
                    <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 date-field-float">
                        <p-calendar data-attr="viewagreement-section-sectionCreation-expirationDate-calendar" formControlName="expirationDate" [showIcon]="true" name="expirationDate"
                            appendTo="body" panelStyleClass="" [minDate]="sectionsCreationModel.expirationMinDate"
                            [maxDate]="sectionsCreationModel.expirationMaxDate"
                            (onInput)="onTypeDate($event.srcElement['value'], 'expiration')"
                            (onSelect)="onDateSelected($event, 1)" [showOnFocus]="true"></p-calendar>
                        <label for="expirationDate" class="leftPlace">Expiration Date</label>
                        <div class="error-class">
                            <p-message severity="error" text="Provide a Expiration Date" *ngIf="sectionsCreationModel.sectionForm.get('expirationDate').touched &&
              sectionsCreationModel.sectionForm.get('expirationDate')['errors']?.required"></p-message>
                            <p-message severity="error" text="Provide a valid date" *ngIf="sectionsCreationModel.sectionForm.get('expirationDate').touched &&
              sectionsCreationModel.sectionForm.get('expirationDate')['errors']?.invalid"></p-message>
                        </div>
                    </span>
                </div>
                <span class="ui-md-12 ui-lg-12 ui-g-12 billto-table">
                    <p-table #codestable [value]="sectionsCreationModel.filteredCodesList"
                        [(selection)]="sectionsCreationModel.selectedCodesList"
                        [loading]="sectionsCreationModel.isBillToLoaded" [resizableColumns]="true"
                        (onHeaderCheckboxToggle)="sectionsCreationModel.sectionForm.markAsDirty()"
                        (onRowSelect)="sectionsCreationModel.sectionForm.markAsDirty()" columnResizeMode="expand"
                        class="billToTable" (onRowUnselect)="sectionsCreationModel.sectionForm.markAsDirty()"
                        [scrollable]="false" [columns]="sectionsCreationModel.codesTableColumns"
                        [globalFilterFields]="['billToCodes', 'assignment', 'assignedDates']" [filterDelay]="0"
                        datakey="billToCodes">
                        <ng-template pTemplate="caption">
                            <div class="ui-g codes-table-caption">
                                <div class="ui-md-6 ui-lg-6">
                                    <span>Bill To Codes
                                        {{(sectionsCreationModel.billToLength ) ? '(' +
                    sectionsCreationModel.billToLength + ')' : ''}}</span>
                                </div>
                                <div class="ui-md-6 ui-lg-6">
                                    <div class="searchHolder">
                                        <div class="ui-inputgroup">
                                            <span class="ui-inputgroup-addon"><em class="fa fa-search"></em></span>
                                            <input type="text" id="codeSearchText" appShortcut="" autocomplete="off"
                                                [ngModelOptions]="{standalone: true}" pInputText placeholder="Search"
                                                appShortcut="" [(ngModel)]="sectionsCreationModel.searchInputValue"
                                                (input)="codestable.filterGlobal($event.target.value, 'contains')"
                                                data-attr="viewagreement-section-billto-search">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="colgroup" let-columns>
                            <colgroup *ngIf="sectionsCreationModel?.codesTableColumns.length > 0">
                                <col>
                                <col *ngFor="let thisCol of sectionsCreationModel.codesTableColumns">
                            </colgroup>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr *ngIf="sectionsCreationModel?.codesList.length === 0">
                                <td colspan="2">
                                    <div class="codesdisplaymiddle"></div>
                                </td>
                            </tr>
                            <tr class="pad0 mar0 table-header" *ngIf="sectionsCreationModel?.codesList.length > 0">
                                <th class="table-header-checkbox checkbox-column">
                                    <p-tableHeaderCheckbox appShortcut focusKey="alt+1"></p-tableHeaderCheckbox>
                                </th>
                                <th colspan=1 *ngFor="let thisCol of sectionsCreationModel.codesTableColumns"
                                    pResizableColumn pTooltip={{thisCol.label}} tooltipPosition="top">
                                    {{thisCol.label}} </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-data let-rowIndex="rowIndex">
                            <tr [pSelectableRow]="rowData">
                                <td class="width10 checkbox-column">
                                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                                </td>
                                <td class="ui-resizable-column"
                                    *ngFor="let thisCol of sectionsCreationModel.codesTableColumns"
                                    pTooltip={{data[thisCol.tooltip]}} tooltipPosition="top">
                                    <span>{{ data[thisCol.key] }}</span>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </span>
            </form>
        </div>
        <div class="split-footer ui-g-12">
            <span class="pull-right mar-top12">
                <button data-attr="viewagreement-section-sectionCreation-dontSave-button" type="text" pButton label="Cancel" appShortcut="ctrl+alt+2" (click)="onClose()"
                    class="ui-button-secondary mar-right15"></button>
                <button data-attr="viewagreement-section-sectionCreation-save-button" type="text" pButton label="Save" appShortcut="ctrl+alt+1" (click)="onSave()"
                    class="ui-button-primary mar-right15"></button>
            </span>
        </div>
    </div>
</div>
<p-dialog data-attr="viewagreement-section-sectionCreation-assignBillto-dialog" #popup header="Assign Bill To Codes" [(visible)]="sectionsCreationModel.isbillToAssignmentPopup"
    [modal]="true" [responsive]="true" [width]="425" [minWidth]="200" [minY]="70" [baseZIndex]="10000"
    [contentStyle]="{'overflow':'visible', 'max-height':'20vh'}" class="footer-float">
    <span *ngIf="!sectionsCreationModel.isAssigned">{{sectionsCreationModel.popupText}}</span>
    <span *ngIf="sectionsCreationModel.isAssigned">
        <span>You are assigning bill to codes already assigned to other sections.</span><br>
        <span>{{sectionsCreationModel.createSectionPopupText}}</span>
    </span>
    <form [formGroup]="sectionsCreationModel.popupFormGroup">
        <div class="ui-md-12 ui-g-12 ui-lg-12 pad0">
            <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 mar-top20 date-field-float pad-left0">
                <p-calendar data-attr="viewagreement-section-sectionCreation-billtoEffective-calendar" formControlName="billtoEffective" [showIcon]="true" name="billtoEffective"
                    [minDate]="sectionsCreationModel.billToEffectiveMinDate"
                    [maxDate]="sectionsCreationModel.billToEffectiveMaxDate" [showOnFocus]="false"
                    (onSelect)="onBillToDateSelected($event, 0)"
                    (onInput)="onBillToTypeDate($event.srcElement['value'], 'effective')"></p-calendar>
                <label for="billtoEffective" class="leftPlace">Effective Date</label>
                <div class="error-class">
                    <p-message severity="error" text="Provide a Effective Date" *ngIf="sectionsCreationModel.popupFormGroup.get('billtoEffective').touched &&
          sectionsCreationModel.popupFormGroup.get('billtoEffective')['errors']?.required"></p-message>
                    <p-message severity="error" text="Provide a valid date" *ngIf="sectionsCreationModel.popupFormGroup.get('billtoEffective').touched &&
          sectionsCreationModel.popupFormGroup.get('billtoEffective')['errors']?.invalid"></p-message>
                </div>
            </span>
            <span class="ui-float-label ui-md-6 ui-lg-6 ui-g-6 mar-top20 date-field-float">
                <p-calendar data-attr="viewagreement-section-sectionCreation-billtoExpiration-calendar" formControlName="billtoExpiration" [showIcon]="true" name="billtoExpiration"
                    [minDate]="sectionsCreationModel.billToExpirationMinDate"
                    [maxDate]="sectionsCreationModel.billToExpirationMaxDate" [showOnFocus]="false"
                    (onSelect)="onBillToDateSelected($event, 1)"
                    (onInput)="onBillToTypeDate($event.srcElement['value'], 'expiration')"></p-calendar>
                <label for="billtoExpiration" class="pad-left6">Expiration Date</label>
                <div class="error-class">
                    <p-message severity="error" text="Provide a Expiration Date" *ngIf="sectionsCreationModel.popupFormGroup.get('billtoExpiration').touched &&
          sectionsCreationModel.popupFormGroup.get('billtoExpiration')['errors']?.required"></p-message>
                    <p-message severity="error" text="Provide a valid date" *ngIf="sectionsCreationModel.popupFormGroup.get('billtoExpiration').touched &&
          sectionsCreationModel.popupFormGroup.get('billtoExpiration')['errors']?.invalid"></p-message>
                </div>
            </span>
        </div>
    </form>
    <p-footer>
        <button data-attr="viewagreement-section-sectionCreation-cancel-button" type="button" pButton class="ui-button-secondary" label="Cancel"
            (click)="sectionsCreationModel.isbillToAssignmentPopup = false"></button>
        <button data-attr="viewagreement-section-sectionCreation-complete-button" type="button" pButton label="Complete" class="ui-button-primary" (click)="billToDateSave()"></button>
    </p-footer>
</p-dialog>
<p-dialog data-attr="viewagreement-section-sectionCreation-confirmation-dialog" [(visible)]="sectionsCreationModel.isShowPopup" [modal]="true" [responsive]="true" [width]="350"
    [minWidth]="200" [minY]="70" [baseZIndex]="10005" [closable]="false">
    <p-header>
        <span class="capitalizeTitle">Confirmation</span>
        <a data-attr="viewagreement-section-sectionCreation-popupCancel-anchor" [ngClass]="{'ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all':true}" href="javascript:void(0)"
            role="button" (click)="popupCancel()">
            <span class="pi pi-times"></span>
        </a>
    </p-header>
    <span>You are about to lose all the changes. Do you want to proceed?</span>
    <p-footer>
        <button type="button" pButton (click)="popupCancel()" class="ui-button-secondary" label="No"
            data-attr="viewagreement-section-sectionCreation-popupno-button"></button>
        <button type="button" pButton (click)="popupYes()" label="Yes" class="ui-button-primary"
            data-attr="viewagreement-section-sectionCreation-popupyes-button"></button>
    </p-footer>
</p-dialog>

<p-dialog data-attr="viewagreement-section-sectionCreation-editSection-dialog" [(visible)]="sectionsCreationModel.isShowChildEntityPopup" [modal]="true" [responsive]="true" [width]="400"
    [minWidth]="275" [baseZIndex]="10005" class="popup-error-msg" (onHide)="countpopupCancel()">
    <p-header>
        <span class="capitalizeTitle">Edit Section</span>
    </p-header>
    <span>You are about to edit {{sectionsCreationModel.sectionName}} for
        {{sectionsCreationModel.agreementName}}.</span><br>
    <span>Below data will be impacted.</span>
    <div class="mar-top10">
        <p-table class="popup-wrapper" [(value)]="sectionsCreationModel.countErrorData">
            <ng-template pTemplate="caption">
                <div class="ui-g codes-table-caption">
                    <div class="ui-md-6 ui-lg-6">
                        <span>Areas Affected</span>
                    </div>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr class="pad0 mar0 table-header">
                    <th class="text-bold pad-left15">
                        Impacts</th>
                    <th class="text-bold pad-left25">
                        Count </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body">
                <tr>
                    <td>
                        Accessorials
                    </td>
                    <td class="pad-left50">
                        {{sectionsCreationModel.accessorialCount}}
                    </td>
                </tr>

                <tr>
                    <td>
                        Cargo Release
                    </td>
                    <td class="pad-left50">{{sectionsCreationModel.countErrorData[0]['cargos']}}</td>
                </tr>
                <tr>
                    <td>
                        Line Haul
                    </td>
                    <td class="pad-left50">{{sectionsCreationModel.countErrorData[0]['linehauls']}}</td>
                </tr>
                <tr>
                    <td>
                        Mileage
                    </td>
                    <td class="pad-left50">{{sectionsCreationModel.countErrorData[0]['mileages']}}</td>
                </tr>
                <tr>
                    <td>
                        Fuel
                    </td>
                    <td class="pad-left50">{{sectionsCreationModel.countErrorData[0]['fuels']}}</td>
                </tr>
                <tr>
                    <td>
                        Rating Rule
                    </td>
                    <td class="pad-left50">{{sectionsCreationModel.countErrorData[0]['ratingRules']}}</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <p-footer>
        <button type="button" pButton (click)="countpopupCancel()" class="ui-button-secondary" label="Cancel"
            data-attr="viewagreement-section-sectionCreation-countPopupCancel-button"></button>
        <button type="button" pButton (click)="countpopupContinue()" label="Continue" class="ui-button-primary"
            data-attr="viewagreement-section-sectionCreation-countPopupContinue-button"></button>
    </p-footer>
</p-dialog>